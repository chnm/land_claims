<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Mapping the Homestead Act</title>
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin=""/>
    <script
        src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
        integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
        crossorigin=""></script>
    <script src="claims.js"></script>
</head>
<body>
    <h1>Claims for <span id="current-year"></span></h1>
    <input style="width: 500px;" id="year-select" type="range" min="1863" max="1896" value="1863">
    <div id="mapid" style="height: 800px;"></div>
</body>
<script>
function getColor(d) {
    return d > 1000 ? '#800026' :
        d > 500  ? '#BD0026' :
        d > 200  ? '#E31A1C' :
        d > 100  ? '#FC4E2A' :
        d > 50   ? '#FD8D3C' :
        d > 20   ? '#FEB24C' :
        d > 10   ? '#FED976' :
        '#FFEDA0';
}
function style(feature) {
    return {
        fillColor: getColor(feature.properties.total_claims),
        weight: 2,
        opacity: 1,
        color: 'white',
        fillOpacity: 0.7
    };
}
function getFeaturedCollection(year) {
    return L.geoJson(featureCollections[year], {
        style: style,
        onEachFeature: function(feature, layer) {
            layer.bindPopup('<table><tr><th>State</th><td>' + feature.properties.state + '</td></tr><tr><th>Claims</th><td>' + feature.properties.total_claims + '</td></tr><tr><th>Acres</th><td>' + feature.properties.total_acres + '</td></tr></table>');
        }
    })
}

var map = L.map('mapid').setView([37.8, -96], 4);
var accessToken = 'pk.eyJ1Ijoiamltc2FmbGV5IiwiYSI6ImNrMjI3dWluMzFvODUzZ3A0d2ZranZ3Y3gifQ.tT-154d2ba__LzjJNLE1cA';
L.tileLayer(
    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=' + accessToken,
    {
        maxZoom: 18,
        id: 'mapbox.light',
    }
).addTo(map);

var yearSelect = document.getElementById('year-select');
var currentYear = document.getElementById('current-year');

var featuredCollection = getFeaturedCollection('1863');
map.addLayer(featuredCollection);
currentYear.innerHTML = '1863';

yearSelect.focus()
yearSelect.addEventListener('change', (event) => {
    map.removeLayer(featuredCollection);
    featuredCollection = getFeaturedCollection(event.target.value);
    map.addLayer(featuredCollection);
    currentYear.innerHTML = event.target.value;
});
</script>
</html>
